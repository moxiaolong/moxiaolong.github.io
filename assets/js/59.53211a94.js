(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{375:function(s,t,n){"use strict";n.r(t);var a=n(8),e=Object(a.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("NFS是linux的远程文件服务，是K8S最简单的PV存储方式。\n"),t("img",{attrs:{src:"/images/devops/nfs.png",alt:"nfs.png"}})]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#安装nfs服务")]),s._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v("  nfs-utils\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#安装rpc服务")]),s._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" rpcbind\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#先启动rpc服务")]),s._v("\nsystemctl start rpcbind\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置开机启动")]),s._v("\nsystemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" rpcbind\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动nfs服务和nfs安全传输服务")]),s._v("\nsystemctl start nfs-server nfs-secure-server\nsystemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" nfs-server nfs-secure-server\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#配置防火墙放行nfs服务")]),s._v("\nfirewall-cmd "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--permanent")]),s._v(" --add-service"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nfs\nfirewall-cmd  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--reload")]),s._v("\t\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建共享目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /home/public/k8sdata\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#编辑配置")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/exports\n\n/home/public/k8sdata "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.*"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rw,insecure,async,no_subtree_check,no_root_squash"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重新加载NFS服务，使配置文件生效")]),s._v("\nsystemctl reload nfs \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br")])]),t("p",[s._v("参数详解：")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("参数")]),s._v(" "),t("th",[s._v("作用")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("rw")]),s._v(" "),t("td",[s._v("读写")])]),s._v(" "),t("tr",[t("td",[s._v("insecure")]),s._v(" "),t("td",[s._v("允许客户端从大于1024的tcp/ip端口连接服务器")])]),s._v(" "),t("tr",[t("td",[s._v("async")]),s._v(" "),t("td",[s._v("将数据先保存在内存缓冲区中，必要时才写入磁盘；")])]),s._v(" "),t("tr",[t("td",[s._v("no_subtree_check")]),s._v(" "),t("td",[s._v("即使输出目录是一个子目录，nfs服务器也不检查其父目录的权限，这样可以提高效率")])]),s._v(" "),t("tr",[t("td",[s._v("no_root_squash")]),s._v(" "),t("td",[s._v("root用户不映射成匿名用户")])])])]),s._v(" "),t("h2",{attrs:{id:"调优"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#调优"}},[s._v("#")]),s._v(" 调优")]),s._v(" "),t("p",[s._v("vi /etc/sysconfig/nfs\nRPCNFSDCOUNT=16")])])}),[],!1,null,null,null);t.default=e.exports}}]);